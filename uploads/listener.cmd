$listener = [System.Net.Sockets.TcpListener]::new([System.Net.IPAddress]::Any, 443)
$listener.Start()
Write-Host "Listening on port 443..."

$client = $listener.AcceptTcpClient()
Write-Host "Connection accepted from $($client.Client.RemoteEndPoint)"

if ($listener.ExclusiveAddressUse) {
    Write-Host "The address is in exclusive use. Access is restricted."
} else {
    Write-Host "The address is not in exclusive use. Access is granted."
}

$client.Close()
$listener.Stop()

start-sleep -s 30